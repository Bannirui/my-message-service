<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.github.bannirui.mms.dal.mapper.TopicMapper" >

    <select id="topicExtEnvByTopicId" resultType="com.github.bannirui.mms.dal.model.TopicEnvHostServerExt">
        select
        topic.id as topicId,
        topic.name as topicName,
        topic.cluster_type as topicType,
        topic.status as topicStatus,
        topic.tps as topicTps,
        topic.msg_sz as topicMsgSz,
        topic.partitions as topicPartitions,
        topic.replication as topicReplication,
        topic.remark as topicRemark,
        topic.user_id as userId,
        topic.app_id as appId,
        env.id as envId,
        env.sort_id as envSort,
        env.name as envName
        from topic
        left join topic_ref on topic.id = topic_ref.topic_id
        left join env on topic_ref.env_id = env.id
        where topic.id = #{topicId}
    </select>
    <select id="topicExtEnvByTopicIds" resultType="com.github.bannirui.mms.dal.model.TopicEnvHostServerExt">
        select
        topic.id as topicId,
        topic.name as topicName,
        topic.cluster_type as topicType,
        topic.status as topicStatus,
        topic.tps as topicTps,
        topic.msg_sz as topicMsgSz,
        topic.partitions as topicPartitions,
        topic.replication as topicReplication,
        topic.remark as topicRemark,
        topic.user_id as userId,
        topic.app_id as appId,
        env.id as envId,
        env.sort_id as envSort,
        env.name as envName
        from topic
        left join topic_ref on topic.id = topic_ref.topic_id
        left join env on topic_ref.env_id = env.id
        where topic.id in
        <foreach collection="topicIds" item="topicId" open="(" separator="," close=")">
            #{topicId}
        </foreach>
    </select>
</mapper>